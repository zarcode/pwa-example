window.setImmediate||function(){"use strict";var n=0,e={},t=!0,r=Array.prototype.slice,i="setImmediatePolyfillMessage";function o(n){var t,o=n.data;"string"==typeof o&&0==o.indexOf(i)&&(t=e[o])&&(delete e[o],function(n){var e=n[0];switch(n.length){case 1:return e();case 2:return e(n[1]);case 3:return e(n[1],n[2])}e.apply(window,r.call(n,1))}(t))}window.setImmediate=function(){for(var r=n++,u=i+r,c=arguments.length,f=new Array(c);c--;)f[c]=arguments[c];return e[u]=f,t&&(t=!1,window.addEventListener("message",o)),window.postMessage(u,"*"),r},window.clearImmediate=function(n){delete e[i+n]}}(),function(n){"use strict";var e="[[PromiseStatus]]",t="[[PromiseValue]]",r="[[OnFulfilled]]",i="[[OnRejected]]",o="[[OriginalError]]",u="pending",c="internal pending",f="fulfilled",a="rejected",s="not an array.",l='constructor Promise requires "new".',d="then() cannot return same Promise that it resolves.",h=n.setImmediate||require("timers").setImmediate,w=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};function m(n){this[o]=n}function p(n){return n instanceof m}function y(n){return"function"==typeof n}function v(n){return n instanceof T}function g(n){return n}function P(n){throw n}function j(n){delete n[r],delete n[i]}function E(n){var e,t=n.length;for(e=0;e<t;e++)n[e]()}function I(n,e,t){var r=O(t);v(r)?r.then(n,e):p(r)?e(r[o]):n(t)}function O(n){var e,t;if(v(n))return n;if(t=n,Object(t)===t){try{e=n.then}catch(n){return new m(n)}if(y(e))return new T(function(t,r){h(function(){try{e.call(n,t,r)}catch(n){r(n)}})})}return null}function b(n,i){function a(t){n[e]==u&&A(n,t)}try{i(function(i){n[e]==u&&function n(i,u){var a,s=O(u);v(s)?(i[e]=c,s.then(function(e){n(i,e)},function(n){A(i,n)})):p(s)?A(i,s[o]):(i[e]=f,i[t]=u,(a=i[r])&&a.length&&(j(i),E(a)))}(n,i)},a)}catch(n){a(n)}}function A(n,r){var o=n[i];n[e]=a,n[t]=r,o&&o.length&&(j(n),E(o))}function T(n){if(!v(this))throw new TypeError(l);this[e]=u,this[t]=void 0,b(this,n)}T.prototype.then=function(n,o){var u,c=this;return n=y(n)?n:g,o=y(o)?o:P,u=new T(function(s,l){function w(n){var e;try{e=n(c[t])}catch(n){return void l(n)}e===u?l(new TypeError(d)):I(s,l,e)}function m(){h(w,n)}function p(){h(w,o)}switch(c[e]){case f:m();break;case a:p();break;default:v=m,g=p,(y=c)[r]||(y[r]=[],y[i]=[]),y[r].push(v),y[i].push(g)}var y,v,g})},T.prototype.catch=function(n){return this.then(g,n)},T.resolve=function(n){var e=O(n);return v(e)?e:new T(function(t,r){p(e)?r(e[o]):t(n)})},T.reject=function(n){return new T(function(e,t){t(n)})},T.race=function(n){return new T(function(e,t){var r,i;if(w(n))for(i=n.length,r=0;r<i;r++)I(e,t,n[r]);else t(new TypeError(s))})},T.all=function(n){return new T(function(e,t){var r,i,u,c,f=0,a=0;if(w(n)){for(i=(n=n.slice(0)).length,c=0;c<i;c++)v(r=O(u=n[c]))?(a++,r.then(function(t){return function(r){n[t]=r,++f==a&&e(n)}}(c),t)):p(r)?t(r[o]):n[c]=u;a||e(n)}else t(new TypeError(s))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||T:n.Promise||(n.Promise=T)}(this);